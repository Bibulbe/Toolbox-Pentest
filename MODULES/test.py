import subprocess
import re
site_web = "https://www.supdevinci.fr/"
# Définition de la commande dirbuster
command = "dirb"
# Définition des options et arguments de la commande
arguments = [site_web, "-r"]
print("Analysis in progress, please be patient...")
# Concaténation des options et arguments en une seule liste
cmd = [command] + arguments
# Exécution de la commande et récupération des résultats en temps réel
process = subprocess.Popen(cmd, stdout=subprocess.PIPE, universal_newlines=True)
pattern = r"\+ \S+ \(CODE:\d+\|SIZE:\d+\)"
for stdout_line in iter(process.stdout.readline, ""):
    match = re.search(pattern, stdout_line)
    if match:
        print(match.group())