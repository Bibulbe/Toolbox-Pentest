import MODULES.ScanPort as ScanPort
import MODULES.pdfGeneral as pdfGen
import MODULES.searchsploitCli as searchsploit

# import markdown2pdf

network2scan = "127.0.0.1"
scan = ScanPort.Nmap(network2scan)
scandict = pdfGen.nmap_dictionarisation(scan)

with open('./AUDIT_TEMPLATE/OUTPUT.md', 'w') as outfile:
    outfile.write(pdfGen.generate_markdown(scan))

# markdown2pdf.convert('./AUDIT_TEMPLATE/OUTPUT.md', outputfile='./AUDIT_TEMPLATE/OUTPUT.pdf')

for scan in scandict:
    print(searchsploit.exploitdbSearch(scan['product'] + ' ' + scan['version'].split(' ')[0]))
